
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>My Octopress Blog</title>
  <meta name="author" content="Your Name">

  
  <meta name="description" content="Got this idea when last week discuss with Rahul G about bloom filters. Put up some draft here, feedback please! &ldquo;Idea&rdquo; Regular bloom &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://yoursite.com/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="My Octopress Blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/"><b>ETHAN'S BLOG</b></a></h1>
    <h2>"This cow gets stuck in a chair"</h2>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="yoursite.com">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
    <li><a href="http://ethanwang.me">Goto Ethan's Page</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2017/01/09/Purposing%20A%20New%20BloomFilter%20that%20optimized%20for%20Hbase/">Purposing a New BloomFilter Design That Optimized for Hbase</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2017-01-09T12:10:00-08:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>9</span><span class='date-suffix'>th</span>, <span class='date-year'>2017</span></span> <span class='time'>12:10 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Got this idea when last week discuss with Rahul G about bloom filters. Put up some draft here, feedback please!</p>

<p><strong>&ldquo;Idea&rdquo;</strong></p>

<p>Regular bloom filter has been widely used in HBase and LSM, however in these cases, certain important knowledge of the key space is pre-known but not been take advantage of. Such as:
1, the MIN/MAX of the keys is pre-known.
2, the keys are usually densely and continuously sorted within a range.</p>

<p><strong>&ldquo;Issues of regular bloom filter&rdquo;</strong></p>

<p>Current bloom filter makes no the assumptions of the distributions of the incoming objects. After hashing, the hashes is assumed to be evenly distributed among (-int, int).
Take most popular implementation for example (google/guava.bloomfilter), there are two processes involved: hashing and modulo, as illustrated below. (code link)</p>

<p><img src="/images/img/p1.jpg">
Fig 1  Two processes for most Bloomfilter implementation. Hashing (fnv or murmur being most popular chooses) and modulo. Modulo operation is usually necessary in order to make hashing range fit into the length of bloom Filter.</p>

<p>Issue is that, no matter which hashing algorithm it choose(fnv or murmur being most popular), a modularization process is usually necessary to fit the size of bloom filter (Such as the Line 61 of com.google.common.hash.BloomFilterStrategies.java code link).</p>

<p>As illustrated below, each bloom filter buckets are not giving the even collision chance therefore yield a sub-optimum collision/space ratio.</p>

<p><img src="/images/img/p2.jpg">
Fig 2. In this example, range of hashes is [4, 29]. When mod this down to [1,10], we can observe that the range [4, 9] will be &ldquo;visit&rdquo; 3 times while other ranges only 2 times. Therefore the items are denser between [4, 9] on the bloom filter.  Reason of this is that the regular bloom filter don&rsquo;t know the min/max value of the incoming objects ahead of time, therefore can not prepare a good corresponding Hash/modulo process for it.</p>

<p><strong>&ldquo;Improvement from HbaseBloomFilter&rdquo;(purposing)</strong></p>

<p>During memstore flushing time, we know Min/Max of the key space a head of time, we can use this information to prepare a better hash and modulo process that avoid this issue. Illustrated below.</p>

<p><img src="/images/img/p3.jpg"></p>

<p><strong>&ldquo;So How much does it improve?&rdquo;</strong></p>

<p>A naive implementation of this idea is that: once hashing is done, based on min and max hash value re-align them based on the bloom filter length. (just implemented here for experiment use Code Link)</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>https://github.com/aertoria/HbaseBloomFilter</span></code></pre></td></tr></table></div></figure>


<p>Experiment Result(each experiment result is the average of multiple experiments):</p>

<p>Bloom filter size is 100, fit in 100 values ranging from 1-150. Use identity based hash:
OldBloomFilter:  Occupied Rate 65%, Collision rate:35%
NewBloomFilter: Occupied Rate 67%, Collision rate:33% (2% better)</p>

<p>Bloom filter size is 10K, fit in 100 values ranging from 1-10K. Use FNV hash:
OldBloomFilter:  Occupied Rate 63.22%, Collision rate:36.78%
NewBloomFilter: Occupied Rate 62.72%, Collision rate:37.28% (0.5% worse)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/10/23/Design%20a%20system%20to%20predict%20future/">How to Design a System to Predict Future</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-10-23T13:23:00-07:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>23</span><span class='date-suffix'>rd</span>, <span class='date-year'>2016</span></span> <span class='time'>1:23 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This post is a draft of something fun I&rsquo;m starting to socialize.</p>

<p>&ldquo;The Problem&rdquo;</p>

<p>This is how this idea gets started: in my day-to-day job, we deal with lots of application servers and database servers. At the center of it, here is the gist: the connection between app server and db server is critical because it directly impacts customer. However, the request that comes down from an app server, due to all sorts of unpredictable reasons, often ends up not reaching the db end. Some times they just got lost, some times they got abandoned.</p>

<p>So we have a whole team to study how can we minimize these cases. The traditional approach is by gathering the knowledge from the past outages, to build a model so we can predict future&hellip; straight forward. If in the past ten incidents, every time incident started we first observed a high CPU usage. Therefore, next time if someone saw another CPU usage peak, it&rsquo;s intuitive to predict the system is likely gonna broke soon.</p>

<p>But how about solve this problem in a different way: can we design a system to in general predict future, like a time machine?</p>

<p>Wait, a time machine?</p>

<p>With this in mind, please read on. So this is a plan: to use the quantum physics help us predict the connectivity between app server and db server..</p>

<p>First, this is the link of Double Slit Experiment. Strongly recommend this video if you haven&rsquo;t read it.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>https://www.youtube.com/watch?v=DfPeprQ7oGc</span></code></pre></td></tr></table></div></figure>


<p>The take away of first video is the following: &ldquo;the particle changes its behavior simply because of &lsquo;aware&rsquo; of being watched&rdquo;</p>

<p>Nest, this one:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>https://www.youtube.com/watch?v=H6HLjpj4Nt4</span></code></pre></td></tr></table></div></figure>


<p>The take away of the second video is, &ldquo;the particle can predict what would have happened in the future, and travel back in time to decide to behave accordingly.&rdquo;</p>

<p>So to sum up, below is a prototype of the system, and has been proved will be functioning, as quoted from this third video(<a href="https://www.youtube.com/watch?v=DsxA7OU7fR0">https://www.youtube.com/watch?v=DsxA7OU7fR0</a>)</p>

<p>&ldquo;The Design&rdquo;</p>

<p>First we have a particle gun, shooting electrons(or photons) through a double-slit barrier and landing on a screen. Both screen and each slit will have a detector connecting to a computer. The detectors attached at each slit will stay on at all time. And their data is constantly being collected by a computer. As in initial state, the screen will show a two-bands, because observer knowledge is collected constantly being collected.</p>

<p>Now, if we leave detectors stay on, but disconnect the cable between the detectors and the computer end, the screen will show a interference pattern. This because no observation knowledge will be successfully collected.</p>

<p>If we think about this for a sec: because the time takes for particle to travel from the slits to screen is almost simultaneous, however the time takes for data to transmit from slit detector to computer is usually much longer, this creates a future-prediction mechanism I can take advantage of: I will read the result from screen, to predict if the ongoing detector data would have or would have not end up at computer end, even thought the detector data bits may be still in the middle of being transmitted!</p>

<p><img src="/images/img/m1.jpg"></p>

<p>&ldquo;An Application&rdquo;</p>

<p>Detector reading is the end that will be carried by our application. Those bits will be packaged into small units, attached with each AppServer-To-DbServer-Request. If customers request can successfully reach the destination, so does the predictor bits. Therefore we should have reading a double-band on screen long before. And vice versa, if the screen starts showing a interference pattern, we will know for sure that soon the connection will broke somewhere, guaranteed.</p>

<p><img src="/images/img/m2.jpg"></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/06/30/To%20GUICE%20all%20in%20one/">GUICE All in One</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-06-30T00:23:00-07:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>30</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>12:23 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>&ldquo;Not enough mana.&rdquo; &ndash;Diablo3</p>

<p>&ldquo;You are right&hellip;.Every project you touched turn into shit&rdquo; &ndash; Nathan Drake, Uncharted 3</p>

<p>Recently I need to work on some core java projects like Argus (<a href="https://github.com/SalesforceEng/Argus">https://github.com/SalesforceEng/Argus</a>). It uses GUICE, as a classic DI framework. After searched around, there is no good tutorial for beginer to quickly jump in&mdash;all materials seem to be incomplete in some way, include the one provided by google/guice. So I decide to make one myself. Thanks to #rajsarkapally-sfdc helped me.</p>

<p>So this is basic idea
<img src="/images/img/9-idea.jpg"></p>

<p>Now let&rsquo;s use one example from Otaku&rsquo;s blog</p>

<p>The more I use dependency injection (DI) in my code, the more it alters the way I see both my design and implementation. Injection is so convenient and powerful that you end up wanting to make sure you use it as often as you can. And as it turns out, you can use it in many, many places.
Let’s cover briefly the most obvious scenarios where DI, and more specifically, Guice, are a good fit: objects created either at class loading time or very early in your application. These two aspects are covered by either direct injection or by providers, which allow you to start building some of your object graph before you can inject more objects. I won’t go too much in details about these two use cases since they are explained in pretty much any Guice tutorial you can find on the net.</p>

<p>Once the injector has created your graph of objects, you are pretty much back to normal and instantiating your “runtime objects” (the objects you create during the life time of your application) the normal way, most likely with “new” or factories. However, you will quickly start noticing that you need some runtime information to create these objects, other parts of them could be injected.</p>

<p>Let’s take the following example: we have a GeoService interface that provides various geolocation functions, such as telling you location if given a person&rsquo;s name:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>package com.salesforce.service;
</span><span class='line'>
</span><span class='line'>public class GeoService implements GeoServiceInterface{
</span><span class='line'>  public boolean judge(String Name){
</span><span class='line'>      System.out.println("juding...");
</span><span class='line'>      return Name.isEmpty()?false:true;
</span><span class='line'>  }
</span><span class='line'>}
</span></code></pre></td></tr></table></div></figure>


<p>Then you have a Person class which uses this service and also needs a name and an address to be instantiated:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>package com.salesforce.kepler;
</span><span class='line'>import com.google.inject.Inject;
</span><span class='line'>import com.google.inject.assistedinject.Assisted;
</span><span class='line'>import com.salesforce.service.GeoServiceInterface;
</span><span class='line'>
</span><span class='line'>public class Person implements PersonInterface {
</span><span class='line'>  private String Name;
</span><span class='line'>  private GeoServiceInterface gs;
</span><span class='line'>  
</span><span class='line'>  private Person(String Name, GeoServiceInterface gs){
</span><span class='line'>      this.Name=Name;
</span><span class='line'>      this.gs=gs;
</span><span class='line'>  }
</span><span class='line'>  public boolean getLocationByName(){
</span><span class='line'>      return gs.judge(Name);
</span><span class='line'>  }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>Something odd should jump at you right away with this class: while name and address are part of the identity of a Person object, the presence of the GeoService instance in it feels wrong. The service is a singleton that is created on start up, so a perfect candidate to be injected, but how can I achieve the creation of a Person object when some of its information is supplied by Guice and the other part by myself?
Guice gives you a very elegant and flexible way to implement this scenario with “assisted injection”. (Quote ended here)</p>

<p><img src="/images/img/9-GUICE.jpg"></p>

<p>Above are basic. To use provider.</p>

<p><img src="/images/img/9-Provider.jpg"></p>

<p>So in the end, this is what you need.</p>

<p><img src="/images/img/9-Automatic.jpg"></p>

<p>Links
<a href="http://stackoverflow.com/questions/9237996/pass-parameter-to-constructor-with-guice">http://stackoverflow.com/questions/9237996/pass-parameter-to-constructor-with-guice</a>
<a href="https://github.com/google/guice/wiki/ProviderBindings">https://github.com/google/guice/wiki/ProviderBindings</a>
<a href="http://beust.com/weblog/2012/08/21/advanced-dependency-injection-with-guice/">http://beust.com/weblog/2012/08/21/advanced-dependency-injection-with-guice/</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/02/29/To%20build%20an%20AI%20like%20never%20before/">To Build an AI Like Never Before</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-02-29T23:23:00-08:00'><span class='date'><span class='date-month'>Feb</span> <span class='date-day'>29</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>11:23 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>JUST a draft&hellip;&hellip;Feb29 night</p>

<p>Ideas about AI.</p>

<p>1, during evolotion, human has this skill of transfer information into knowledge. But is running on a slow crappy computer(brain) with low memory and horrible inter-connection. &hellip;if it can be simulated on modern computer, with computer&rsquo;s high inter-connection and spped, will be supper.
2, Right now, All AI development I learned so far are based on mathmatic. From English langurage sentiment catogrizing to picture pattern matching&hellip;.those ANN or SVM are all based on mathmatic logic reasoning and caculation. Those are not the way when I learn stuff and get intelligence.</p>

<p>Therefore,</p>

<p>Yesturday, I consiousely trying hard to record the process of how I learning a new thing&hellip;..So that I may be able to see the process of
how do normal people transfer infomation into knowledge when they learn a new thing&hellip;..I think this is a key piece that is missing to make AI really work.
So I learned a new terminlogy called Selenium. And this is what I recorded:
1, I remember I heard it years ago.
2, I saw on web there is a digram, three layer, selenium is in the middle. So I know it&rsquo;s a key thing that connceting up and down.
Therefore I decide to learn this Selenium.
So far, What I did was, I try to draw a structure diagram/picture in my head. And now when I keep reading things about this Selenium,</p>

<p>I try to PLACE this selenium into that structure.
And, during that, for every new piece of info I got, I was also trying to fit it so that I&rsquo;m also validating the correctness of
that structrue.
Based on this process, I think I should build an AI, not purly mathmatical based(like traditional deep learning(ANN)), but this way</p>

<p>Step 1: crawling web and dig out a new terminology
Step 2: read about this terminology and trying to place it into a network diagram, whilst also validating/revising the digram itself.
Step 3: Repeat from Step 1
I&rsquo;m going talk this with Shahlesh about this idea tomorrow</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/01/25/angularJS%20template/">AngularJS Template</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-01-25T10:06:00-08:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>25</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>10:06 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This post wrap up a hello-world demo for ngularJS web app, and should serve well as a template.</p>

<p>AngularJS is also MVC. However, different from true MVC, it&rsquo;s everything running at client side within javascript runtime. Which means less performance and less security.</p>

<p>So what is Microservice Architecture:
<img src="/images/img/angularjs.jpg"></p>

<p>index.html</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;html lang="en" ng-app="mvcApp"&gt;
</span><span class='line'>&lt;head&gt;
</span><span class='line'>  &lt;script src="bower_components/angular/angular.js"&gt;&lt;/script&gt;
</span><span class='line'>  &lt;script src="bower_components/angular-route/angular-route.js"&gt;&lt;/script&gt;
</span><span class='line'>  &lt;script src="main/main.js"&gt;&lt;/script&gt;
</span><span class='line'>  &lt;script src="about/about.js"&gt;&lt;/script&gt;
</span><span class='line'>&lt;/head&gt;
</span><span class='line'>&lt;body&gt;
</span><span class='line'>
</span><span class='line'>  &lt;p&gt;Hello world index page&lt;/p&gt;
</span><span class='line'>  &lt;div ng-view&gt;this used for routing&lt;/div&gt;
</span><span class='line'>
</span><span class='line'>&lt;/body&gt;
</span><span class='line'>&lt;/html&gt;</span></code></pre></td></tr></table></div></figure>


<p>main.js</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>'use strict';
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>/* App Module */
</span><span class='line'>var mvcApp = angular.module('mvcApp', [
</span><span class='line'>      'ngRoute',
</span><span class='line'>      'module_about'
</span><span class='line'>      ]);
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>mvcApp.config(['$routeProvider',
</span><span class='line'>  function($routeProvider) {
</span><span class='line'>      //console.log($routeProvider)
</span><span class='line'>      $routeProvider.when('/about', {
</span><span class='line'>              templateUrl: 'about/about.html',
</span><span class='line'>              controller: 'aboutCrtl'
</span><span class='line'>          }).otherwise({
</span><span class='line'>              redirectTo: '/about'
</span><span class='line'>          });
</span><span class='line'>  }]);</span></code></pre></td></tr></table></div></figure>


<p>about/about.html</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;h2&gt;About page&lt;/h2&gt;
</span><span class='line'>Author is: 
</span><span class='line'>&lt;helloworld/&gt;</span></code></pre></td></tr></table></div></figure>


<p>about/about.js</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>//Declaration of this module
</span><span class='line'>var module_about = angular.module('module_about',[]);
</span><span class='line'>
</span><span class='line'>/* Controllers */
</span><span class='line'>module_about.controller('aboutCrtl',['$scope','aboutFac',aboutCrtl]);
</span><span class='line'>function aboutCrtl($scope,aboutFac){
</span><span class='line'>  $scope.about_author='ethan wang';
</span><span class='line'>  //Now I'm going to use this factory
</span><span class='line'>  aboutFac.doGreet();
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>/* Model */
</span><span class='line'>module_about.factory('aboutFac',aboutFac);
</span><span class='line'>function aboutFac(){
</span><span class='line'>  var factory={};
</span><span class='line'>  factory.doGreet = function(){
</span><span class='line'>      alert('doGreet method called!');
</span><span class='line'>  }
</span><span class='line'>  return factory;
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>//TO show case about directive
</span><span class='line'>mvcApp.directive('helloworld',helloworldDirective);
</span><span class='line'>function helloworldDirective(){
</span><span class='line'>  return {
</span><span class='line'>      restrict: 'AEC',
</span><span class='line'>      replace: 'true',
</span><span class='line'>      template: '&lt;h3&gt;Helloworld! Welcome to About page!!&lt;/h3&gt;',
</span><span class='line'>      link: function(scope, element, attrs){
</span><span class='line'>          element.bind('click',function(){
</span><span class='line'>              alert('you clicked!');
</span><span class='line'>              //scope.$apply(function(){scope.color = "black";});
</span><span class='line'>          });
</span><span class='line'>      }
</span><span class='line'>  }
</span><span class='line'>}
</span></code></pre></td></tr></table></div></figure>


<p>To access code and see hello world in 5 sec, just go to this link:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>https://github.com/Template-EthanFavoriate/TEMPLATE_ANGULARJS.git</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/11/08/review%20earphone%20equipment/">Why Are There So Many Songs About Rainbow? ---My Journey as an Audiophile</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-11-08T20:42:22-08:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>8</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>8:42 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>So why to become am audiophile?</p>

<p>As a person watching computer screen all day, researching audio equipment (earphone headphone) is one of only few hobbies that I have. To investing on them is easily proven to be cost-efficent: I listen to them while I use computer, which is pretty much all day. Anyways, it&rsquo;s been 5 years since I stepped into this once-step-in-no-step-back hi-fi journey. I decided to write something to wrap them up and give beginners some advices.</p>

<p>So why earphone?</p>

<p>As a way of enjoying sound, first off you have some options. You may go one of these three: speakers(those loud speaker boxes), headphones or earphones. First speaker is no brainer not an option for me, they are heavy to move and I can&rsquo;t use them in office. Headphones are also bad because some open back ones leaks sound pretty bad which I also can not use in office. Ideally the one I&rsquo;m looking for is something supper low-profile and not compromising hi-fidelity at the same time.</p>

<p>Journey of Sennheiser CX300</p>

<p>My journey starts from Sennheiser CX300, an earphone that designed for entry-level users. Even though my first CX300 turn out to be not an authentic one from Sennheiser, but it sounded just amazing, as I have no other to compare, and it opened a door for me to this aspiring hi-fidelity world. That one costs me about 40 bucks, which was quite a lot for me at that moment as a junior undergraduate. My biggest impressions were great isolation and surrounding feeling. Never before has a earphone feels so comfortable and so sound-isolating that after wearing it for a while, you magically feel the sound volume somehow gets turned up. Great isolation also leads to great surrounding feeling enriching any song with so much flavor and imaging.</p>

<p>->for beginners: In general at this price range(Less than $50), you are expecting some major improvement compare to apple&rsquo;s earbuds. The ecstasy of trance begin to appear, and you will find yourself quite enjoying from the repetition of those trances in a music.</p>

<p>It is still in general horrible, for pretty much all earphones at this range, to handle classics or jazz. But for popular music and some vocals, this range is a great start. Recommend: Xiaomi Piston 2.(great great earphone at this range kind of overkills all others)</p>

<p>Journey of Sennheiser IE6</p>

<p>When I was still at Iowa doing my college program, one day at Cyber Monday I saw Sennheiser IE6 was list as a lighting-deal, pricing at $99. Therefore that soon became my second milestone on earphones. I have been marrying IE 6 for about 2 years straight. Hands down great earphones. I would&rsquo;ve continue use then if not their cable finally worn out and I failed to fix them after couple tries. IE is a class that designed for audiophiles, and IE6 is an entry-level of that class.</p>

<p>->for beginners: At this price range ($50 - $200), there are a bunch of great earphones or headphones that are available. You will feel they are 1 to 2 level better than the previous price range, specially when comes down to fidelity and balance. They are considered &lsquo;sub-flagships&rsquo; and is in my view the most cost-efficent price range to stay on. However compare to the flagships (IE 8, SE535, EX1000 etc), they more or less has one or two flaws regarding bass, mid-range or treble.</p>

<p>At this point they usually handle very well at popular music. Some maybe good at one particular genre than others, such as vocals or ACGs. Still, most are struggling at classics and jazz. Recommend: SE215, ATH M50x(it&rsquo;s a headphone).</p>

<p>Journey of Shure SE535</p>

<p>Then comes SE535. In a word, I regret having bought it. Unlike my every other upgrades, which I usually felt satisfying and sense of accomplishments afterwards, the purchase of SE535 however was a disaster. She impressed me by a lot at first, then left me craving for more. For the starters, SE535 has a great fidelity, which means lots of details. It enables me to notice much more details that I wasn&rsquo;t aware of, even from a song that I was looping all day long. The best of SE535 was her mid-range. Those &lsquo;pure liquid gold&rsquo; was just incredible. This earphone made me think, the ultimate goal of audiophile, rather than to pursue those hard specs, is to &lsquo;find yourself being moved&rsquo;. When listening Tori Kelly was singing Colors of the wind, or when V.K was in the middle performing his piano solo Reflection, SE535 made me realize, after all, at its core, the music is an art of expressing feelings. And to accomplish this connection between listener and performer you will have to also involve your imagination&hellip;..SE535 gives you all that. She not only precisely captures the music structures and every other details, it blends them all into a poem or a story. This magic earphone forced me to ignore every individual instruments, but to focus on performer&rsquo;s enthusiasm that deep inside. As a result, I feel Tori Kelly&rsquo;s voice was so real that her lip were literally 1 inch away from my ear. It&rsquo;s addictive. It&rsquo;s almost a guilty pleasure.</p>

<p>Now, here is deal breaker. Besides middle range and vocals, everything else about SE535 is depressing. Specially when comes down to sound stage. The bass and treble is just OMG bad. Till one day I decide not to tolerate those anymore and I moved on.</p>

<p>->for beginners: At this price range($200 - $600), you will have to do a major study regarding the genre you usually listen to. There are SE535, IE 8, TF 10, Sony EX1000 and ATH CK100 etc. If you are looking for something that is a versatile, slightly analytical and well balanced, my recommendation is Westone W4R.</p>

<p>My current Stuff.
HD600, HD800, LCD 2.
AKG K701, JH13Pro, DAC/Amp Audist HUD MX1, Pico Slim, Fiio E8</p>

<p>Some pictures. And I will keep updating.</p>

<p><img src="/images/img/1.jpg">
<img src="/images/img/2.jpg">
<img src="/images/img/3.jpg"></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/11/07/micro%20service%20template/">Django Micro-services Template</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-11-07T08:24:22-08:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>7</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>8:24 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This post wrap up a hello-world demo for django Microservices web app, and shold serve well as a template.</p>

<p>First, What is Pattern: Microservices Architecture:</p>

<p>refer below from <a href="http://microservices.io/patterns/microservices.html">http://microservices.io/patterns/microservices.html</a></p>

<p>Context
You are developing a server-side enterprise application. It must support a variety of different clients including desktop browsers, mobile browsers and native mobile applications. The application might also expose an API for 3rd parties to consume. It might also integrate with other applications via either web services or a message broker. The application handles requests (HTTP requests and messages) by executing business logic; accessing a database; exchanging messages with other systems; and returning a HTML/JSON/XML response.</p>

<p>The application has either a layered or hexagonal architecture and consists of different types of components:</p>

<p>Presentation components - responsible for handling HTTP requests and responding with either HTML or JSON/XML (for web services APIS)
Business logic - the application’s business logic
Database access logic - data access objects responsible for access the database
Application integration logic - messaging layer, e.g. based on Spring integration.
There are logical components corresponding to different functional areas of the application.</p>

<p>The motivations are :</p>

<p>There is a team of developers working on the application
New team members must quickly become productive
The application must be easy to understand and modify
You want to practice continuous deployment of the application
You must run multiple copies of the application on multiple machines in order to satisfy scalability and availability requirements
You want to take advantage of emerging technologies (frameworks, programming languages, etc)</p>

<p>So what is Microservice Architecture:
<img src="/images/img/4.jpg"></p>

<p>Reference ends here. Now start my demo code. Below is how I plan to do it:
<img src="/images/img/5.png"></p>

<p>Tier one app. It&rsquo;s an empty app, only has Settings.py and url.py is important. You start your whole application by bootstraping this app python manage.py runserver from here.</p>

<p>settings.py</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>INSTALLED_APPS = (
</span><span class='line'>    'django.contrib.admin',
</span><span class='line'>    'django.contrib.auth',
</span><span class='line'>    'django.contrib.contenttypes',
</span><span class='line'>    'django.contrib.sessions',
</span><span class='line'>    'django.contrib.messages',
</span><span class='line'>    'django.contrib.staticfiles',
</span><span class='line'>    'keplerapp_tbcheck',
</span><span class='line'>    'keplerapp_tbmodel',
</span><span class='line'>)</span></code></pre></td></tr></table></div></figure>


<p>url.py</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>urlpatterns = patterns('',
</span><span class='line'>    # Examples:
</span><span class='line'>    # url(r'^$', 'keplerweb.views.home', name='home'),
</span><span class='line'>    # url(r'^blog/', include('blog.urls')),
</span><span class='line'>    url(r'^demo/', include(keplerapp_tbcheck.urls)),
</span><span class='line'>    url(r'^$', include(keplerapp_tbcheck.urls)),
</span><span class='line'>    url(r'^admin/', include(admin.site.urls)),
</span><span class='line'>    #url(r'^$', include(admin.site.urls))
</span><span class='line'>)</span></code></pre></td></tr></table></div></figure>


<p>Now go to another tier one app, tbcheck. This app serves as view app, with all template, tamplate tag, css stuff there
url.py</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>urlpatterns = patterns('',
</span><span class='line'>    url(r'', 'keplerapp_tbcheck.views.service_check'),
</span><span class='line'>    url(r'template', 'keplerapp_tbcheck.views.service_default')
</span><span class='line'>)</span></code></pre></td></tr></table></div></figure>


<p>views.py</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>from keplerapp_tbmodel.models import Employee
</span><span class='line'>
</span><span class='line'>def service_check(request):
</span><span class='line'>    emp = Employee()
</span><span class='line'>    emp.truncate()
</span><span class='line'>    emp.prepare_data()
</span><span class='line'>
</span><span class='line'>    sec_orglist = map(lambda x:x.EmpName,emp.get_Name_by_OrgID(2))
</span><span class='line'>
</span><span class='line'>    context={}
</span><span class='line'>    context['sec_orglist']=sec_orglist
</span><span class='line'>    context['dictionary_key_A']='value of dictionary key A: 10230'
</span><span class='line'>    return render_to_response('keplerapp_tbcheck/intro_index.html', context)
</span><span class='line'>
</span><span class='line'>def service_default(request):
</span><span class='line'>    #return HttpResponse("defalt page 404")
</span><span class='line'>    return render_to_response('keplerapp_tbcheck/intro_index.html', {})</span></code></pre></td></tr></table></div></figure>


<p>At last is tier two app. tbmodel</p>

<p>Only has models.py in it. It is just another package.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>from django.db import models
</span><span class='line'>from datetime import datetime
</span><span class='line'>
</span><span class='line'>class Employee(models.Model):
</span><span class='line'>  EmpID = models.AutoField(primary_key=True,blank=True)
</span><span class='line'>  OrgId = models.CharField(max_length=50, db_index=True)#PNC
</span><span class='line'>  EmpLevelCode = models.IntegerField(db_index=True,blank=True,null=True)#6
</span><span class='line'>  EmpName = models.CharField(max_length=100)#Gender
</span><span class='line'>  EmpGender = models.CharField(max_length=50,blank=True,null=True)#F
</span><span class='line'>  EmpHire_dttm = models.DateTimeField(blank=True,null=True)
</span><span class='line'>  upd_dttm = models.DateTimeField(auto_now=True)
</span><span class='line'>
</span><span class='line'>  def __unicode__(self):
</span><span class='line'>      return u'System: %s'%self.EmpName
</span><span class='line'>
</span><span class='line'>  class Meta:
</span><span class='line'>      app_label = 'keplerapp_tbmodel'
</span><span class='line'>      db_table = u'employee'
</span><span class='line'>
</span><span class='line'>  #Return a Generic object
</span><span class='line'>  @classmethod
</span><span class='line'>  def get_Name_by_EmpID(cls,EmpID):
</span><span class='line'>      return cls.objects.filter(EmpID=EmpID)
</span><span class='line'>
</span><span class='line'>  @classmethod
</span><span class='line'>  def get_Name_by_OrgID(cls,OrgId):
</span><span class='line'>      return cls.objects.filter(OrgId=OrgId)
</span><span class='line'>
</span><span class='line'>  @classmethod
</span><span class='line'>  def truncate(cls):
</span><span class='line'>      cls.objects.all().delete()
</span><span class='line'>
</span><span class='line'>  @classmethod
</span><span class='line'>  def prepare_data(cls):
</span><span class='line'>      Employee(OrgId='2',EmpLevelCode=1,EmpName='Ethan W').save()
</span><span class='line'>      Employee(OrgId='2',EmpLevelCode=1,EmpName='Tom H').save()
</span><span class='line'>      Employee(OrgId='2',EmpLevelCode=2,EmpName='Eric G').save()
</span><span class='line'>      Employee(OrgId='3',EmpLevelCode=1,EmpName='Larry E').save()
</span><span class='line'>      Employee(OrgId='3',EmpLevelCode=2,EmpName='Larry P').save()</span></code></pre></td></tr></table></div></figure>


<p>now when we run it, we first pip install all view, model app as package to site-package places. Then bootstrap the first app to start.</p>

<p>To access code and see hello world in 5 sec, just go to this link:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>https://github.com/Template-EthanFavoriate/TEMPLATE_MICROSERVICE
</span><span class='line'>git@github.com:Template-EthanFavoriate/TEMPLATE_MICROSERVICE.git</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/06/22/Where%20did%20preformance%20go/">Where Did Preformance Go? Dive Into Multi-process/multi-threads in CPython</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-06-22T13:31:14-07:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>22</span><span class='date-suffix'>nd</span>, <span class='date-year'>2015</span></span> <span class='time'>1:31 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&rsquo;ve been run in to this kind of problem recently: one day I found out a solution written in python multi-thread approach take more running time than single thread. This is really confusing. I decided to dive into that&hellip;and some interesting stuff were found out.</p>

<p>Note that my computer is multi-core processor cpu. i7 2.3Ghz QuardCore CPU, 16G DDR3 Memory. With SSD Hard Drive.</p>

<p>Essentially every thing starts from this little piece of code recursively solving a permutation problem</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#!/usr/bin/python
</span><span class='line'>import datetime
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>L = [1,2,3,4,5,7,8,9,10,11]
</span><span class='line'>
</span><span class='line'>def gen(index,value):
</span><span class='line'>  if index==len(L):
</span><span class='line'>      return 1
</span><span class='line'>  count=0
</span><span class='line'>  for i in range(len(value)+1):
</span><span class='line'>      count+=gen(index+1,value[:i]+[L[index]]+value[i:])
</span><span class='line'>  return count</span></code></pre></td></tr></table></div></figure>


<p>Below are how it was wroted in single thread, multi-thread and multi-process. Along with the running time.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>#Single thread approach
</span><span class='line'>#time0=datetime.datetime.now()
</span><span class='line'>#print gen(1,[1]) #runtime 480ms-10   4500ms-11  50sec-12 11&gt;&gt;&gt;&gt;&gt;0:00:04.823974
</span><span class='line'>#time1=datetime.datetime.now()
</span><span class='line'>#print time1-time0
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>pointer1=0
</span><span class='line'>pointer2=0
</span><span class='line'>def t1_start():
</span><span class='line'>  global pointer1
</span><span class='line'>  pointer1=gen(2,[2,1])
</span><span class='line'>  print pointer1
</span><span class='line'>
</span><span class='line'>def t2_start():
</span><span class='line'>  global pointer2
</span><span class='line'>  pointer2=gen(2,[1,2])
</span><span class='line'>  print pointer2
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>#from threading import Thread
</span><span class='line'>#t1=Thread(target=t1_start,args=())
</span><span class='line'>#t2=Thread(target=t2_start,args=())
</span><span class='line'>#time0=datetime.datetime.now()
</span><span class='line'>#t1.start()
</span><span class='line'>#t2.start()
</span><span class='line'>#t1.join()
</span><span class='line'>#t2.join()
</span><span class='line'>#time1=datetime.datetime.now()
</span><span class='line'>#print pointer1+pointer2,time1-time0 #runtime 650ms-10  6392ms-11 72sec -12 11&gt;&gt;&gt;&gt;&gt;&gt;&gt;0:00:05.082194
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>import multiprocessing
</span><span class='line'>p1=multiprocessing.Process(target=t1_start,args=())
</span><span class='line'>p2=multiprocessing.Process(target=t2_start,args=())
</span><span class='line'>time0=datetime.datetime.now()
</span><span class='line'>p1.start()
</span><span class='line'>p2.start()
</span><span class='line'>p1.join()
</span><span class='line'>p2.join()
</span><span class='line'>time1=datetime.datetime.now()
</span><span class='line'>print pointer1+pointer2,time1-time0 #runtime 480ms-10 4400ms-11 48sec-12   &gt;&gt;&gt;&gt;&gt;&gt;&gt;02.225561
</span><span class='line'>
</span><span class='line'>#
</span><span class='line'>#</span></code></pre></td></tr></table></div></figure>


<p>Also, I simply increased the task from 10 digit array to 12 digit array, this takes roughly 1 min for the node to solve the problem. so the new result is this: single thread: 50 sec; multi-thread: 72 sec. I also tried implement it using multi-process. surprisingly multi-process cut the time in half. so the basically result is:</p>

<p>single thread  RUNTIME T
multi-thread   RUNTIME T
multi-process  RUNTIME T/2</p>

<p>This does not explain why there is no improvement from single thread to multi-threads. therefore I took a snapshot of CPU workload.
<img src="/images/img/CPU_History.jpg"></p>

<p>Note that even single thread it actually involves all my cpu cores. I&rsquo;m now suspecting maybe CPython interpreter/optimizer or Intel CPU instruction set is pretty smart to handle even single thread solution to force it run on multiple CPUs.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/06/20/DFS%20BFS/">Standard DFS and BFS</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-06-20T13:31:14-07:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>20</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>1:31 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>given a graph below</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#!/usr/bin/python
</span><span class='line'>
</span><span class='line'>graph={}
</span><span class='line'>
</span><span class='line'>graph['A']=['B','D']
</span><span class='line'>graph['B']=['A','E','C']
</span><span class='line'>graph['C']=['B']
</span><span class='line'>graph['D']=['A','E']
</span><span class='line'>graph['E']=['B','D']</span></code></pre></td></tr></table></div></figure>


<p>To traverse this simple graph, usually people go on and on talking about DFS and BFS, and there are many versions of algorithm book 101 talk about the way of implementing it. Today I got asked again by a colleague, and after search around online surprisingly I found there is a no good example anywhere that set a standard for beginners to start. Therefore I coded one for him. And it was pretty tricky since there are some caveat need be take into consideration. I decided to post that here so that it can benefit other people who might need it.</p>

<p>Start with this DFS. I call it classic-DFS
This gives the good DFS: It Ends when All NODE ARE VISITED</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>def DFS(node):
</span><span class='line'>  print node,visited
</span><span class='line'>  for next in graph[node]:
</span><span class='line'>      if next not in visited:
</span><span class='line'>          visited.append(next)
</span><span class='line'>          DFS(next)
</span><span class='line'>          print 'returnning'
</span><span class='line'>visited=['A']
</span><span class='line'>DFS('A')</span></code></pre></td></tr></table></div></figure>


<p>This one is difference than the one above, it gives all possible path DFS: it ends when ALL PATH ARE SEARCHED.
It also very good for circle detecting. I call it standard DFS or S-DFS</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>def SDFS(node):
</span><span class='line'>  print node,stack
</span><span class='line'>  for next in graph[node]:
</span><span class='line'>      if next not in stack:
</span><span class='line'>          stack.append(next)
</span><span class='line'>          SDFS(next)
</span><span class='line'>          stack.pop()
</span><span class='line'>          print 'returnning'
</span><span class='line'>#     elif next in stack and next &lt;&gt; stack[-2]:
</span><span class='line'>#         print 'circle!'
</span><span class='line'>
</span><span class='line'>stack=['A']
</span><span class='line'>SDFS('A')</span></code></pre></td></tr></table></div></figure>


<p>Now this one is a BFS one. it is very straight forward.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>def BFS(node):
</span><span class='line'>  global Q
</span><span class='line'>  print node,Q
</span><span class='line'>  for next in graph[node]:
</span><span class='line'>      if next not in visted:
</span><span class='line'>          Q.append(next)
</span><span class='line'>          visited.append(next)
</span><span class='line'>  Q=Q[1:]
</span><span class='line'>  while len(Q)&gt;0:
</span><span class='line'>      next=Q[0]
</span><span class='line'>      BFS(next)
</span><span class='line'>
</span><span class='line'>Q=['A']
</span><span class='line'>visited=['A']
</span><span class='line'>#BFS('A')</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/01/15/hello-world/">Deploy Octpress</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-01-15T12:19:22-08:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>15</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>12:19 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>To relase me:</p>

<p>rysnc then at my root fold do rake genrate rake watch</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rake generate
</span><span class='line'>rake watch</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/2">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2017/01/09/Purposing%20A%20New%20BloomFilter%20that%20optimized%20for%20Hbase/">Purposing a New BloomFilter Design That Optimized for Hbase</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/10/23/Design%20a%20system%20to%20predict%20future/">How to Design a System to Predict Future</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/06/30/To%20GUICE%20all%20in%20one/">GUICE All in One</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/02/29/To%20build%20an%20AI%20like%20never%20before/">To Build an AI Like Never Before</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/01/25/angularJS%20template/">AngularJS Template</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/11/08/review%20earphone%20equipment/">Why Are There So Many Songs About Rainbow? ---My Journey as an Audiophile</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/11/07/micro%20service%20template/">Django Micro-services Template</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/06/22/Where%20did%20preformance%20go/">Where Did Preformance Go? Dive Into Multi-process/multi-threads in CPython</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/06/20/DFS%20BFS/">Standard DFS and BFS</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/01/15/hello-world/">Deploy Octpress</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/05/27/SpringVsRails/">Some Comments Regarding Spring vs Rails</a>
      </li>
    
  </ul>
</section>
Included file 'asides/github.html' not found in _includes directory



  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; ethanwang.me -
  <span class="credit">I use <a href="http://octopress.org">Octopress</a> to set up this blog</span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
